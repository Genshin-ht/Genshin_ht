
<!DOCTYPE html>
<html lang="zh-CN" class="no-js">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="csrf-token" content="1745586362:fcRHNa2hnR5KmR0HEPx/81sTubcXK3/BRwIEakYMSVI=">
    <meta name="renderer" content="webkit">
    <script>
        window.__feInitLocalTime = new Date().getTime() / 1000;
        window.__feConfigVersion = 'b8940f11703f4480'; window.__feConfigRequest = '\/_lfe\/config';
        window.__luoguTagVersion = 'zh\u002DCN\/2025042420'; window.__luoguTagRequest = '\/_lfe\/tags\/zh\u002DCN';
            </script>
    <title>CF1714D Color with Occurrences - 洛谷</title>
    <link rel="icon" href="https://fecdn.luogu.com.cn/favicon.ico">
    <meta http-equiv="Content-Security-Policy" content="default-src 'unsafe-inline' luogu.com *.luogu.com luogu.com.cn *.luogu.com.cn luogu.org *.luogu.org luoguprivate.oss-cn-hangzhou.aliyuncs.com luogu.oss-cn-hangzhou.aliyuncs.com https://challenges.cloudflare.com wss: blob:; img-src * data:; font-src * data:; worker-src data: blob:; frame-src https://player.bilibili.com https://www.bilibili.com https://challenges.cloudflare.com">    <script id="lentille-context" type="application/json">{"instance":"main","template":"problem.show","status":200,"locale":"zh-CN","data":{"problem":{"pid":"CF1714D","type":"CF","title":"Color with Occurrences","difficulty":4,"submitted":false,"accepted":false,"tags":[3,7],"wantsTranslation":false,"totalSubmit":680,"totalAccepted":327,"flag":5,"provider":{"uid":3,"avatar":"https:\/\/cdn.luogu.com.cn\/upload\/usericon\/3.png","name":"\u6d1b\u8c37","slogan":"","badge":null,"isAdmin":true,"isBanned":false,"color":"Purple","ccfLevel":0,"background":""},"contenu":null,"content":{"user":null,"version":1,"name":"Color with Occurrences","background":"","description":"You are given some text $ t $ and a set of $ n $ strings $ s_1, s_2, \\dots, s_n $ .\n\nIn one step, you can choose any occurrence of any string $ s_i $ in the text $ t $ and color the corresponding characters of the text in red. For example, if $ t=\\texttt{bababa} $ and $ s_1=\\texttt{ba} $ , $ s_2=\\texttt{aba} $ , you can get $ t=\\color{red}{\\texttt{ba}}\\texttt{baba} $ , $ t=\\texttt{b}\\color{red}{\\texttt{aba}}\\texttt{ba} $ or $ t=\\texttt{bab}\\color{red}{\\texttt{aba}} $ in one step.\n\nYou want to color all the letters of the text $ t $ in red. When you color a letter in red again, it stays red.\n\nIn the example above, three steps are enough:\n\n- Let\u0027s color $ t[2 \\dots 4]=s_2=\\texttt{aba} $ in red, we get $ t=\\texttt{b}\\color{red}{\\texttt{aba}}\\texttt{ba} $ ;\n- Let\u0027s color $ t[1 \\dots 2]=s_1=\\texttt{ba} $ in red, we get $ t=\\color{red}{\\texttt{baba}}\\texttt{ba} $ ;\n- Let\u0027s color $ t[4 \\dots 6]=s_2=\\texttt{aba} $ in red, we get $ t=\\color{red}{\\texttt{bababa}} $ .\n\nEach string $ s_i $ can be applied any number of times (or not at all). Occurrences for coloring can intersect arbitrarily.\n\nDetermine the minimum number of steps needed to color all letters $ t $ in red and how to do it. If it is impossible to color all letters of the text $ t $ in red, output -1.","formatI":"The first line of the input contains an integer $ q $ ( $ 1 \\le q \\le 100 $ ) \u2014the number of test cases in the test.\n\nThe descriptions of the test cases follow.\n\nThe first line of each test case contains the text $ t $ ( $ 1 \\le |t| \\le 100 $ ), consisting only of lowercase Latin letters, where $ |t| $ is the length of the text $ t $ .\n\nThe second line of each test case contains a single integer $ n $ ( $ 1 \\le n \\le 10 $ ) \u2014 the number of strings in the set.\n\nThis is followed by $ n $ lines, each containing a string $ s_i $ ( $ 1 \\le |s_i| \\le 10 $ ) consisting only of lowercase Latin letters, where $ |s_i| $ \u2014 the length of string $ s_i $ .","formatO":"For each test case, print the answer on a separate line.\n\nIf it is impossible to color all the letters of the text in red, print a single line containing the number -1.\n\nOtherwise, on the first line, print the number $ m $ \u2014 the minimum number of steps it will take to turn all the letters $ t $ red.\n\nThen in the next $ m $ lines print pairs of indices: $ w_j $ and $ p_j $ ( $ 1 \\le j \\le m $ ), which denote that the string with index $ w_j $ was used as a substring to cover the occurrences starting in the text $ t $ from position $ p_j $ . The pairs can be output in any order.\n\nIf there are several answers, output any of them.","hint":"The first test case is explained in the problem statement.\n\nIn the second test case, it is impossible to color all the letters of the text in red.","locale":"en"},"attachments":[],"acceptSolution":false,"acceptLanguages":[5,1,2,28,3,4,11,12,27,7,25,8,33,15,14,19,30,31,32,21,22,17,9,16,13,23],"samples":[["6\nbababa\n2\nba\naba\ncaba\n2\nbac\nacab\nabacabaca\n3\naba\nbac\naca\nbaca\n3\na\nc\nb\ncodeforces\n4\ndef\ncode\nefo\nforces\naaaabbbbcccceeee\n4\neeee\ncccc\naaaa\nbbbb","3\n2 2\n1 1\n2 4\n-1\n4\n1 1\n2 6\n3 3\n3 7\n4\n3 1\n1 2\n2 3\n1 4\n2\n4 5\n2 1\n4\n3 1\n4 5\n2 9\n1 13"]],"limits":{"time":[2000],"memory":[256000]},"stdCode":"","showScore":false,"vjudge":{"id":"1714D","link":"https:\/\/codeforces.com\/problemset\/problem\/1714\/D"},"translation":"\u7ed9\u5b9a\u4e00\u6bb5\u9ed1\u8272\u6587\u672c $t$ \u548c\u591a\u4e2a\u5b57\u7b26\u4e32 $s_1,s_2...s_n$\u3002\n\n\u4e00\u6b21\u64cd\u4f5c\u53ef\u4ee5\u5c06 $t$ \u4e2d\u4efb\u610f\u4e00\u4e2a\u4e0e\u4efb\u610f $s$ \u76f8\u7b49\u7684\u5b50\u4e32\u6d82\u6210\u7ea2\u8272\u3002\u4e24\u6b21\u6d82\u7ea2\u7684\u5b57\u6bcd\u4ecd\u7136\u662f\u7ea2\u8272\u3002$s$ \u6ca1\u6709\u4f7f\u7528\u6b21\u6570\u9650\u5236\u3002\u6c42\u5168\u6d82\u6210\u7ea2\u8272\u6700\u5c0f\u6b21\u6570\u548c\u65b9\u6848\uff0c\u4efb\u610f\u8f93\u51fa\u4e00\u79cd\u89e3\u3002\n\n\u4e00\u5171\u6709 $q$ \u7ec4\u6d4b\u8bd5\u6570\u636e\u3002\n\n\u4e3e\u4f8b\uff1a\n\n $ t=\\texttt{bababa} \\ \\  s_1=\\texttt{ba} $ , $ s_2=\\texttt{aba} $ \n \n \u4e00\u6b65\u53ef\u4ee5\u5f97\u5230 $ t=\\color{red}{\\texttt{ba}}\\color{black}\\texttt{baba} $ , $ t=\\texttt{b}\\color{red}{\\texttt{aba}}\\color{black}\\texttt{ba} $ or $ t=\\texttt{bab}\\color{red}{\\texttt{aba}} $ \u4e2d\u7684\u4e00\u4e2a\u3002\n \n \u5168\u90e8\u6d82\u7ea2\u6240\u9700 $3$ \u6b65\u5982\u4e0b\uff1a\n \n - \u6d82\u7ea2 $ t[2 \\dots 4]=s_2=\\texttt{aba} $ \u5f97 $ t=\\texttt{b}\\color{red}\\texttt{aba}\\color{black}\\texttt{ba} $ ;\n- \u6d82\u7ea2 $ t[1 \\dots 2]=s_1=\\texttt{ba} $ \u5f97 $ t=\\color{red}\\texttt{baba}\\color{black}\\texttt{ba} $ ;\n- \u6d82\u7ea2 $ t[4 \\dots 6]=s_2=\\texttt{aba} $ \u5f97 $ t=\\color{red}{\\texttt{bababa}} $ ."},"translations":{"en":{"user":null,"version":1,"name":"Color with Occurrences","background":"","description":"You are given some text $ t $ and a set of $ n $ strings $ s_1, s_2, \\dots, s_n $ .\n\nIn one step, you can choose any occurrence of any string $ s_i $ in the text $ t $ and color the corresponding characters of the text in red. For example, if $ t=\\texttt{bababa} $ and $ s_1=\\texttt{ba} $ , $ s_2=\\texttt{aba} $ , you can get $ t=\\color{red}{\\texttt{ba}}\\texttt{baba} $ , $ t=\\texttt{b}\\color{red}{\\texttt{aba}}\\texttt{ba} $ or $ t=\\texttt{bab}\\color{red}{\\texttt{aba}} $ in one step.\n\nYou want to color all the letters of the text $ t $ in red. When you color a letter in red again, it stays red.\n\nIn the example above, three steps are enough:\n\n- Let\u0027s color $ t[2 \\dots 4]=s_2=\\texttt{aba} $ in red, we get $ t=\\texttt{b}\\color{red}{\\texttt{aba}}\\texttt{ba} $ ;\n- Let\u0027s color $ t[1 \\dots 2]=s_1=\\texttt{ba} $ in red, we get $ t=\\color{red}{\\texttt{baba}}\\texttt{ba} $ ;\n- Let\u0027s color $ t[4 \\dots 6]=s_2=\\texttt{aba} $ in red, we get $ t=\\color{red}{\\texttt{bababa}} $ .\n\nEach string $ s_i $ can be applied any number of times (or not at all). Occurrences for coloring can intersect arbitrarily.\n\nDetermine the minimum number of steps needed to color all letters $ t $ in red and how to do it. If it is impossible to color all letters of the text $ t $ in red, output -1.","formatI":"The first line of the input contains an integer $ q $ ( $ 1 \\le q \\le 100 $ ) \u2014the number of test cases in the test.\n\nThe descriptions of the test cases follow.\n\nThe first line of each test case contains the text $ t $ ( $ 1 \\le |t| \\le 100 $ ), consisting only of lowercase Latin letters, where $ |t| $ is the length of the text $ t $ .\n\nThe second line of each test case contains a single integer $ n $ ( $ 1 \\le n \\le 10 $ ) \u2014 the number of strings in the set.\n\nThis is followed by $ n $ lines, each containing a string $ s_i $ ( $ 1 \\le |s_i| \\le 10 $ ) consisting only of lowercase Latin letters, where $ |s_i| $ \u2014 the length of string $ s_i $ .","formatO":"For each test case, print the answer on a separate line.\n\nIf it is impossible to color all the letters of the text in red, print a single line containing the number -1.\n\nOtherwise, on the first line, print the number $ m $ \u2014 the minimum number of steps it will take to turn all the letters $ t $ red.\n\nThen in the next $ m $ lines print pairs of indices: $ w_j $ and $ p_j $ ( $ 1 \\le j \\le m $ ), which denote that the string with index $ w_j $ was used as a substring to cover the occurrences starting in the text $ t $ from position $ p_j $ . The pairs can be output in any order.\n\nIf there are several answers, output any of them.","hint":"The first test case is explained in the problem statement.\n\nIn the second test case, it is impossible to color all the letters of the text in red.","locale":"en"}},"bookmarked":false,"contest":null,"vjudgeUsername":null,"lastLanguage":28,"lastCode":"","lastCodeAt":null,"recommendations":[],"forum":{"name":"CF1714D Color with Occurrences","type":2,"slug":"CF1714D","color":"orange-3"},"discussions":[{"id":883463,"title":"\u7384\u5b66RE\uff0c\u6c42\u52a9","author":{"uid":732034,"avatar":"https:\/\/cdn.luogu.com.cn\/upload\/usericon\/732034.png","name":"Exscallop64_","slogan":"\u6d41\u6d6a\u5251\u5ba2 || Never Stop || xkcd","badge":null,"isAdmin":false,"isBanned":false,"color":"Orange","ccfLevel":6,"background":"https:\/\/cdn.luogu.com.cn\/upload\/image_hosting\/zabfd59s.png"},"time":1723034090},{"id":473777,"title":"\u7384\u5b66\u9505\u6c42\u8c03","author":{"uid":113521,"avatar":"https:\/\/cdn.luogu.com.cn\/upload\/usericon\/113521.png","name":"muyang_233","slogan":"enfj|\u9614\u8010\u7684\u84dd\u5b69\u7eb8|MOer\/OIer","badge":null,"isAdmin":false,"isBanned":false,"color":"Gray","ccfLevel":6,"background":"https:\/\/cdn.luogu.com.cn\/upload\/image_hosting\/18by2ic3.png"},"time":1659947800},{"id":470017,"title":"\u82f1\u8bed\u9898\u9762\u51fa\u9505","author":{"uid":217300,"avatar":"https:\/\/cdn.luogu.com.cn\/upload\/usericon\/217300.png","name":"Error_Eric","slogan":"\u7ec8\u7a76\u8fd8\u662f\u610f\u96be\u5e73","badge":null,"isAdmin":false,"isBanned":false,"color":"Red","ccfLevel":6,"background":"https:\/\/cdn.luogu.com.cn\/upload\/image_hosting\/pkd5rnjh.png"},"time":1659411038}],"locale":"zh-CN","canEdit":false},"user":{"uid":1646296,"avatar":"https:\/\/cdn.luogu.com.cn\/upload\/usericon\/1646296.png","name":"Genshin_ht","slogan":"\u300e\u68a6\u5f00\u59cb\u7684\u5730\u65b9\u300f| \u4e92\u5173\u770b\u4e3b\u9875","badge":null,"isAdmin":false,"isBanned":false,"color":"Cheater","ccfLevel":0,"background":"https:\/\/cdn.luogu.com.cn\/upload\/image_hosting\/l2bp77c2.png","verified":true,"followingCount":0,"followerCount":0,"ranking":null,"unreadMessageCount":0,"unreadNoticeCount":0},"time":1745499961.957964,"theme":{"id":23758,"header":{"imagePath":"https:\/\/cdn.luogu.com.cn\/upload\/image_hosting\/tv18fzg3.png","color":[[0,0,0,1]],"blur":0,"brightness":1,"degree":125,"repeat":0,"position":[50,100],"size":[-1,-1],"type":1,"__CLASS_NAME":"Luogu\\DataClass\\User\\ThemeConfig\\HeaderFooterConfig"},"sideNav":{"logoBackgroundColor":[0,174,127,0.96],"color":[0,0,0,1],"invertColor":false,"__CLASS_NAME":"Luogu\\DataClass\\User\\ThemeConfig\\SideNavConfig"},"footer":{"imagePath":"https:\/\/cdn.luogu.com.cn\/upload\/image_hosting\/6cjrnuyo.png","color":[[0,0,0,1]],"blur":0,"brightness":1,"degree":116,"repeat":0,"position":[1,1],"size":[-1,-1],"type":1,"__CLASS_NAME":"Luogu\\DataClass\\User\\ThemeConfig\\HeaderFooterConfig"}}}</script>            <script src="https://fecdn.luogu.com.cn/columba/loader.20250421-953.js" charset="utf-8" defer></script>
    <link rel="stylesheet" href="https://fecdn.luogu.com.cn/columba/loader.20250421-953.css" />
    <script src="https://fecdn.luogu.com.cn/columba/vendor.20250421-953.js" charset="utf-8" defer></script>
        <script type="application/ld+json">{"@context":"https:\/\/schema.org","name":"CF1714D Color with Occurrences","description":"You are given some text  t  and a set of  n  strings  s_1, s_2, \\dots, s_n  .\nIn one step, you can choose any occurrence\u2026"}</script>
    <link rel="canonical" href="https://www.luogu.com.cn/problem/CF1714D" />
            <link rel="alternate" hreflang="en" href="https://www.luogu.com.cn/problem/CF1714D?lang=en" />
        <meta property="og:locale" content="en" />
        <meta property="og:site_name" content="洛谷" />
    <meta property="og:title" content="CF1714D Color with Occurrences" />
    <meta property="og:description" content="You are given some text  t  and a set of  n  strings  s_1, s_2, \dots, s_n  .
In one step, you can choose any occurrence…" />
    <meta property="og:url" content="https://www.luogu.com.cn/problem/CF1714D" />
    <style>body { --lfe-code-font: "Cascadia Code"; }</style>
</head>
<body>
<div id="app">
    <noscript>
        <h3>请<b style="color:#f00;">不要禁用</b>脚本，否则网页无法正常加载</h3>
    </noscript>
        <article lang="en">
        <h1>CF1714D Color with Occurrences</h1>

        
        <section>
            <h2>Description</h2>
            <div>
                                    You are given some text $ t $ and a set of $ n $ strings $ s_1, s_2, \dots, s_n $ .

In one step, you can choose any occurrence of any string $ s_i $ in the text $ t $ and color the corresponding characters of the text in red. For example, if $ t=\texttt{bababa} $ and $ s_1=\texttt{ba} $ , $ s_2=\texttt{aba} $ , you can get $ t=\color{red}{\texttt{ba}}\texttt{baba} $ , $ t=\texttt{b}\color{red}{\texttt{aba}}\texttt{ba} $ or $ t=\texttt{bab}\color{red}{\texttt{aba}} $ in one step.

You want to color all the letters of the text $ t $ in red. When you color a letter in red again, it stays red.

In the example above, three steps are enough:

- Let's color $ t[2 \dots 4]=s_2=\texttt{aba} $ in red, we get $ t=\texttt{b}\color{red}{\texttt{aba}}\texttt{ba} $ ;
- Let's color $ t[1 \dots 2]=s_1=\texttt{ba} $ in red, we get $ t=\color{red}{\texttt{baba}}\texttt{ba} $ ;
- Let's color $ t[4 \dots 6]=s_2=\texttt{aba} $ in red, we get $ t=\color{red}{\texttt{bababa}} $ .

Each string $ s_i $ can be applied any number of times (or not at all). Occurrences for coloring can intersect arbitrarily.

Determine the minimum number of steps needed to color all letters $ t $ in red and how to do it. If it is impossible to color all letters of the text $ t $ in red, output -1.
                            </div>
        </section>

        <section>
            <h2>Input Format</h2>
            <div>
                                    <i>N/A</i>
                            </div>
        </section>

        <section>
            <h2>Output Format</h2>
            <div>
                                    <i>N/A</i>
                            </div>
        </section>

        <section>
            <h2>Explanation/Hint</h2>
            <div>
                The first test case is explained in the problem statement.

In the second test case, it is impossible to color all the letters of the text in red.
            </div>
        </section>    </article>
</div>
</body>
</html>
